"use strict";let initialDrinks=[],drinks=[];const searchText=document.querySelector(".js_searchText"),searchButton=document.querySelector(".js_searchButton"),listsContainer=document.querySelector(".js_listsContainer"),errorContainer=document.querySelector(".js_errorContainer"),searchContainer=document.querySelector(".js_searchContainer"),searchList=document.querySelector(".js_searchList"),searchTitle=document.querySelector(".js_searchTitle");let favorites=[];const favoritesContainer=document.querySelector(".js_favorites"),favoritesList=document.querySelector(".js_favoritesList"),deleteAllFavoritesButton=document.querySelector(".js_resetFavorites"),searchesMenuButton=document.querySelector(".js_showSearches"),favoriteMenuButton=document.querySelector(".js_showFavorites"),favoritesIcon=document.querySelector(".js_favoritesIcon"),searchesIcon=document.querySelector(".js_searchesIcon"),favoriteDrinkList=JSON.parse(localStorage.getItem("favoriteDrinkList")),menuAddClass=(e,t)=>{e.classList.add("menu__item--"+t)},menuRemoveClass=(e,t)=>{e.classList.remove("menu__item--"+t)},menuShowFavorites=()=>{menuAddClass(searchesMenuButton,"hideSearches"),menuAddClass(favoriteMenuButton,"showFavorites"),menuRemoveClass(searchesMenuButton,"showSearches"),menuRemoveClass(favoriteMenuButton,"hideFavorites")},menuShowSearches=()=>{menuAddClass(searchesMenuButton,"showSearches"),menuAddClass(favoriteMenuButton,"hideFavorites"),menuRemoveClass(searchesMenuButton,"hideSearches"),menuRemoveClass(favoriteMenuButton,"showFavorites")},handleShowFavorites=()=>{favoritesContainer.classList.remove("hidden"),searchContainer.classList.add("hidden"),menuAddClass(searchesMenuButton,"hideSearches"),menuAddClass(favoriteMenuButton,"showFavorites"),menuRemoveClass(searchesMenuButton,"showSearches"),menuRemoveClass(favoriteMenuButton,"hideFavorites"),favoritesIcon.setAttribute("name","heart"),searchesIcon.setAttribute("name","wine-outline")};favoriteMenuButton.addEventListener("click",handleShowFavorites);const handleShowSearches=()=>{searchContainer.classList.remove("hidden"),favoritesContainer.classList.add("hidden"),menuAddClass(searchesMenuButton,"showSearches"),menuAddClass(favoriteMenuButton,"hideFavorites"),menuRemoveClass(searchesMenuButton,"hideSearches"),menuRemoveClass(favoriteMenuButton,"showFavorites"),searchesIcon.setAttribute("name","wine"),favoritesIcon.setAttribute("name","heart-outline")};searchesMenuButton.addEventListener("click",handleShowSearches);const createLiItem=(e,t,r)=>{const s=document.createElement("li");return s.classList.add(e,t),s.setAttribute("id",r.id),s},createImgItem=(e,t)=>{const r=document.createElement("img");return""===e.image?(r.setAttribute("src","https://via.placeholder.com/210x295/ffffff/666666/?text=img"),r.setAttribute("alt",e.name),r.classList.add(t)):(r.setAttribute("src",e.image+"/preview"),r.setAttribute("alt",e.name),r.classList.add(t)),r},createh3Item=(e,t)=>{const r=document.createElement("h3");r.classList.add(e);const s=document.createTextNode(t.name);return r.appendChild(s),r},favoriteDrink=(e,t)=>{-1!==favorites.findIndex(t=>t.id===e.id)&&t.classList.add("drink--favorite")},deletePreviusRenderedDrinks=()=>{const e=document.querySelectorAll(".js_drinks");for(const t of e)t.remove()},deletePreviusInitialDrinks=()=>{const e=document.querySelectorAll(".js_initialDrinks");for(const t of e)t.remove()},deletePreviousQueries=()=>{listsContainer.classList.contains("hidden")?deleteErrorMessage():searchList.innerHTML=""};function initialGetFromAPI(){fetch("https://www.thecocktaildb.com/api/json/v1/1/filter.php?g=Cocktail_glass").then(e=>e.json()).then(e=>{const t=e.drinks;initialDrinks=t.map(e=>({id:e.idDrink,name:e.strDrink,image:e.strDrinkThumb}));const r=initialDrinks.sort(()=>Math.random()-.5).splice(7,20);initialDrinks=r,renderInitialDrinks(),renderFavorites(favorites),searchTitle.innerHTML="Algunos cócteles"}).catch(()=>{searchContainer.classList.add("hidden"),deletePreviousQueries(),deleteErrorMessage(),errorMessage("No lo intentes. Hazlo o no lo hagas. Pero en este caso inténtalo de nuevo por favor. Hemos tenido un problemilla momentáneo.","./assets/images/noTrys.jpg","Yoda",'El imperio contrataca - Yoda enseñando a luke a usar la fuerza - "No lo intentes. Hazlo o no lo hagas. Pero no lo intentes."')})}function renderInitialDrinks(){for(const e of initialDrinks){const t=createLiItem("drink","js_initialDrinks",e);favoriteDrink(e,t);const r=createImgItem(e,"drink__image");t.appendChild(r);const s=createh3Item("drink__title",e);t.appendChild(s),searchList.appendChild(t)}listenersRenderedInitialDrinks()}function handleClickSearchButton(e){e.preventDefault();validateInputValue(searchText.value.toLowerCase())}initialGetFromAPI(),searchButton.addEventListener("click",handleClickSearchButton);const createPErrorItem=e=>{const t=document.createElement("p");t.classList.add("error__text","js_errorText");const r=document.createTextNode(e);return t.appendChild(r),t},createImgErrorItem=(e,t,r)=>{const s=document.createElement("img");return s.classList.add("error__image","js_errorImage"),s.setAttribute("src",e),s.setAttribute("alt",t),s.setAttribute("title",r),s},errorMessage=(e,t,r,s)=>{errorContainer.classList.remove("hidden"),listsContainer.classList.add("hidden");const n=createPErrorItem(e);if(errorContainer.appendChild(n),void 0!==t){const e=createImgErrorItem(t,r,s);errorContainer.appendChild(e);const n=document.createElement("button");n.classList.add("backToListButton","js_backToListButton");const i=document.createTextNode("Volver");n.appendChild(i),errorContainer.appendChild(n),listenerDeleteFavoritesButton()}},deleteErrorMessage=()=>{if(!errorContainer.classList.contains("hidden")){const e=document.querySelectorAll(".js_errorText"),t=document.querySelector(".js_errorImage"),r=document.querySelector(".js_backToListButton");for(const t of e)t.remove();t.remove(),r.remove(),errorContainer.classList.add("hidden"),rerenderFavorites()}},handleClickBackToListButton=()=>{deleteErrorMessage(),listsContainer.classList.remove("hidden"),handleShowSearches(),renderInitialDrinks(),searchTitle.innerHTML="Algunos cócteles",searchText.value=""};function listenerDeleteFavoritesButton(){document.querySelector(".js_backToListButton").addEventListener("click",handleClickBackToListButton)}function validateInputValue(e){""===e?(deletePreviousQueries(),errorMessage("Nada, es inútil. No sé qué será."),errorMessage("Es un acertijo: Di, *nombre del cóctel que quieres buscar* y encuentra.","./assets/images/LOR.jpg","Puerta de Moria",'La Comunidad del Anillo - Puerta de Moria - "Di amigo y entra".')):getFromServer(e)}function getFromServer(e){fetch("https://www.thecocktaildb.com/api/json/v2/1/search.php?s="+e).then(e=>e.json()).then(t=>{const r=t.drinks;null===r?(deletePreviousQueries(),errorMessage("Lo siento. Mis respuestas son limitadas. Haz las consultas correctas.","./assets/images/rightSearchs.jpg","Doctor Alfred Lanning",'Yo, Robot - Interrogatorio al doctor Alfred Lanning por el detective Del Spooner, después de su muerte. - "Lo siento. Mis respuestas son limitadas. Haz las preguntas correctas."')):(drinks=r.map(e=>({id:e.idDrink,name:e.strDrink,image:e.strDrinkThumb})),deletePreviousQueries(),renderDrinks(),handleShowSearches(),searchTitle.innerHTML=e)}).catch(()=>{searchContainer.classList.add("hidden"),deletePreviousQueries(),errorMessage("No lo intentes. Hazlo o no lo hagas. Pero en este caso inténtalo de nuevo por favor. Hemos tenido un problemilla momentáneo.","./assets/images/noTrys.jpg","Yoda",'El imperio contrataca - Yoda enseñando a luke a usar la fuerza - "No lo intentes. Hazlo o no lo hagas. Pero no lo intentes."')})}function renderDrinks(){listsContainer.classList.remove("hidden"),deletePreviusInitialDrinks();for(const e of drinks){const t=createLiItem("drink","js_drinks",e);favoriteDrink(e,t);const r=createImgItem(e,"drink__image");t.appendChild(r);const s=createh3Item("drink__title",e);t.appendChild(s),searchList.appendChild(t)}listenersRenderedDrinks()}function addRemoveToFavorites(e,t){const r=e.currentTarget.id,s=t.find(e=>e.id===r),n=favorites.findIndex(e=>e.id===r);-1===n?favorites.push(s):favorites.splice(n,1)}const rerenderDrinks=()=>{deletePreviusRenderedDrinks(),renderDrinks()},rerenderInitialDrinks=()=>{deletePreviusInitialDrinks(),renderInitialDrinks()},rerenderFavorites=()=>{favoritesList.classList.contains("hidden")&&deleteErrorEmptyFavorites(),deletePreviusRenderedFavorites(),renderFavorites(favorites)};function handleClickRenderedDrinks(e){addRemoveToFavorites(e,drinks),setLocalStorage(),rerenderDrinks(),rerenderFavorites()}function handleClickInitialDrinks(e){addRemoveToFavorites(e,initialDrinks),setLocalStorage(),rerenderInitialDrinks(),rerenderFavorites()}function listenersRenderedDrinks(){const e=document.querySelectorAll(".js_drinks");for(const t of e)t.addEventListener("click",handleClickRenderedDrinks)}function listenersRenderedInitialDrinks(){const e=document.querySelectorAll(".js_initialDrinks");for(const t of e)t.addEventListener("click",handleClickInitialDrinks)}function renderFavorites(e){if(0!==e.length){for(const t of e){const e=document.createElement("li");e.classList.add("favorite","js_favorite"),e.setAttribute("id",t.id);const r=document.createElement("img");""===t.image?(r.setAttribute("src","https://via.placeholder.com/210x295/ffffff/666666/?text=img"),r.setAttribute("alt",t.name),r.classList.add("favorite__image")):(r.setAttribute("src",t.image+"/preview"),r.setAttribute("alt",t.name),r.classList.add("favorite__image")),e.appendChild(r);const s=document.createElement("h3");s.classList.add("favorite__title");const n=document.createTextNode(t.name);s.appendChild(n),e.appendChild(s);const i=document.createElement("button");i.classList.add("deleteFavorite","js_deleteFavorite"),i.setAttribute("id",t.id);const o=document.createElement("ion-icon");o.classList.add("deleteFavorite__icon"),o.setAttribute("name","heart-dislike-outline"),i.appendChild(o),e.appendChild(i),favoritesList.appendChild(e)}listenersDeleteFavoritesButton()}else{favoritesList.classList.add("hidden"),deleteAllFavoritesButton.classList.add("hidden");const e=createPErrorItem("A ver cómo te lo explico..."),t=createPErrorItem("eehh...está vacío...¿ves?"),r=createPErrorItem("No hay cócteles aquí"),s=createImgErrorItem("./assets/images/monstruos.jpg","Monstruos S.A. - Boo está asustada por si hay monstruos en el armario y Sulley le enseña que está vacío","A ver cómo se lo explico...eehh...está vacío...¿ves? No hay monstruos aquíii.");favoritesContainer.append(e,t,r,s)}}const deletePreviusRenderedFavorites=()=>{const e=document.querySelectorAll(".js_favorite");for(const t of e)t.remove()},deleteErrorEmptyFavorites=()=>{const e=document.querySelectorAll(".js_errorText");for(const t of e)t.remove();document.querySelector(".js_errorImage").remove(),favoritesList.classList.remove("hidden"),deleteAllFavoritesButton.classList.remove("hidden")};function handleClickDeleteFavorites(e){const t=e.currentTarget.id,r=favorites.findIndex(e=>e.id===t);-1!==r&&favorites.splice(r,1),localStorage.setItem("favoriteDrinkList",JSON.stringify(favorites)),0!==drinks.length?(rerenderDrinks(),rerenderFavorites()):(rerenderInitialDrinks(),rerenderFavorites())}function listenersDeleteFavoritesButton(){const e=document.querySelectorAll(".js_deleteFavorite");for(const t of e)t.addEventListener("click",handleClickDeleteFavorites)}function handleClickDeleteAllFavorites(e){e.preventDefault(),favorites=[],localStorage.removeItem("favoriteDrinkList"),0!==drinks.length?(rerenderDrinks(),rerenderFavorites()):(rerenderInitialDrinks(),rerenderFavorites())}deleteAllFavoritesButton.addEventListener("click",handleClickDeleteAllFavorites);const setLocalStorage=()=>{localStorage.setItem("favoriteDrinkList",JSON.stringify(favorites))};null!==favoriteDrinkList&&(favorites=favoriteDrinkList);